
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <div>

    <nav class="navbar navbar-expand-lg navbar-light bg-light w-100 d-flex justify-content-center">
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        
        <form class="form-inline my-2 my-lg-0 ">
          <input id="search" class="form-control" type="text" name="search" placeholder="Rechercher" [(ngModel)]="searchText">
        </form>
        <!-- <ul class="navbar-nav mr-auto">
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Dropdown
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#">Action</a>
              <a class="dropdown-item" href="#">Another action</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="#">Something else here</a>
            </div>
          </li>
          
        </ul> -->
      </div>
    </nav>
  </div>
  
  
  <div class="container"  *ngIf="!showForm">
<!-- <nav id="nav">  
   
        <div class="bouton">
        <input id="search" class="form-control" type="text" name="search" placeholder="Rechercher" [(ngModel)]="searchText">
        </div> 
</nav>  -->
    
 
      <table class="table table-bordered " >  
    <thead>
      <tr class="bg-danger" > 
       
        <th scope="col">MATRICULE</th>
        <th scope="col">NOM</th>
        <th scope="col">PRENOM</th>
        <th scope="col">EMAIL</th>
        <th scope="col">ROLES</th>
        <th scope="col">ACTION</th>
      </tr>
    </thead>     
          <tbody class="tbody">    
         <tr *ngFor="let user of userActif | paginate: { itemsPerPage:  itemsperpage, currentPage: p} | filter:searchText">  
          <td class="col-2">{{user.matricule}}</td> 
          <td class="col-2">{{user.nom}}</td> 
          <td class="col-2">{{user.prenom}}</td>             
          <td class="col-2">{{user.email}}</td>           
          <td class="col-2">{{user.roles}}</td>
      <td class="d-flex justify-content-arround col-2"> 
        <span class="btn btn-outline-danger" title="archiver" (click)="deleteId(user._id,user.etat)"><i class="bi bi-archive" id="i1" ></i></span>
        &nbsp;
        <span  class="btn btn-outline-primary" title="modifier" (click)="getUserData(user._id,user.email,user.prenom,user.nom)"><i class="bi bi-pen-fill" id="i2" ></i></span>
        &nbsp;
        <span  class="btn btn-outline-primary" title="changer" (click)="changeRole(user._id,user.roles)"><i class="bi bi-arrow-clockwise" ></i></span></td> 
                      
        </tr>   
        </tbody>
     </table>

     <div class="mt-8 py-5">
      <div>
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
      </div>
   </div>
   </div>  
   
   


  <form *ngIf="showForm" [formGroup]="userEditForm"  class="col-6" style="margin: 0 auto;">
    <input type="text" formControlName="id"  hidden>
    <span *ngIf="emailExiste" class="d-flex justify-content-center fadeIn">
        <p class="text text-danger">{{emailExiste}}</p>
    </span>
 
    <div class="form-outline mb-2">
      <div class="input-control">
  <label class="form-label" for="form2Example11">Nom</label>
  <input id="form2Example11" name="nom"  class=" p-3 rounded-0" type="text"
  [ngClass]="{'is-invalid':submitted && userEditForm.controls['nom'].errors}" placeholder="nom"
  formControlName="nom" class="form-control">
 <div *ngIf="submitted && userEditForm.controls['nom'].errors" class="text-danger" name="nom">
  <div *ngIf="submitted && userEditForm.controls['nom'].errors required">
      Ce champ est  require
  </div> 
   <div *ngIf="!submitted && userEditForm.controls['nom'].errors['cannotContainSpace']">
      ne met pas espace
  </div> 
  </div>
 
</div>
</div>
 
<div class="form-outline mb-2">
  <div class="input-control">
<label class="form-label" for="form2Example11">Prenom</label>
<input id="form2Example11" name="prenom"  class=" p-3 rounded-0" type="text"
[ngClass]="{'is-invalid':submitted && userEditForm.controls['prenom'].errors}" placeholder="prenom"
formControlName="prenom" class="form-control">
<div *ngIf="submitted && userEditForm.controls['prenom'].errors" class="text-danger" name="prenom">
<div *ngIf="submitted && userEditForm.controls['prenom'].errors required">
  Ce champ est  require
</div> 
<div *ngIf="!submitted && userEditForm.controls['prenom'].errors['cannotContainSpace']">
  ne met pas espace
</div> 
</div>

</div>
</div>
  <div class="mb-3">
      <label class="form-label" for="email">EMAIL</label>
    <input type="email" class="form-control" formControlName="email">
  </div>
  <div class="d-flex justify-content-space">
    <button type="submit" (click)="modifUsers()" class="btn btn-primary">Modifier</button>
    <button  class="btn btn-danger" (click)="this.showForm = false;">Annuler</button>
  </div>
</form> 
   

</body>
</html>